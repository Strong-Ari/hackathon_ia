<!-- Generated by SpecStory -->

# From Background: Développer pages historique et profil (2025-07-19 14:52Z)

_**User**_

1.2 Onglet “Historique des notifications”
Créer une page dédiée avec :

Une liste verticale de toutes les notifications reçues

Chaque carte de notif doit afficher :

Titre

Message

Timestamp formaté (ex. "Aujourd'hui à 14h32")

Un bouton ou icône volume permettant de relire l’audio associé (audio_file)

Design fluide, responsive et stylé (Material 3 ou custom)

Astuce : stocke localement les notifications dans un List<NotificationModel> pour éviter de relire depuis l’API.

👤 Partie 2 — Profil Producteur
Dans l’Espace Producteur, ajouter une page “Profil” accessible depuis la barre de navigation.

Elle doit inclure :

📸 Photo de profil ou avatar

🧑‍🌾 Nom complet du producteur

🌱 Présentation libre (zone de texte stylée)

🧺 Liste de productions agricoles sous forme de cartes ou tags :

Type de culture

Quantité moyenne

Saison

Statut (en stock, vendu, etc.)

🔧 Possibilité d’éditer les informations (avec une icône ou bouton)

Style : Inspiré d’un mini portfolio agricole, moderne et clean, avec une vibe premium.

🧠 Contraintes Générales
Ne modifie pas le backend ni l’API.

Utilise un design très soigné, ergonomique et moderne.

N’utilise pas de notifications natives.

Le code doit rester modulaire, commenté, et évolutif.

---

_**Assistant**_

Je vais examiner le projet pour comprendre la structure existante et implémenter les fonctionnalités demandées.

---

<details>
            <summary>Listed directory undefined • **30** results</summary>
        
| Name |
|-------|
| 📁 `.git` |
| 📄 `UI_ARCHITECTURE.md` |
| 📄 `hackathon_ia.iml` |
| 📁 `lib` |
| 📄 `pubspec.yaml` |
| 📁 `.idea` |
| 📄 `DEMARRAGE_RAPIDE_UI.md` |
| 📄 `GUIDE_DEMARRAGE_NOTIFICATIONS.md` |
| 📄 `NOTIFICATIONS_VOCALES.md` |
| 📁 `Python` |
| 📁 `assets` |
| 📄 `ARCHITECTURE.md` |
| 📄 `LICENSE` |
| 📄 `PROJECT_SUMMARY.md` |
| 📄 `QUICKSTART.md` |
| 📄 `README.md` |
| 📄 `RESOLUTION_PROBLEMES.md` |
| 📄 `analysis_options.yaml` |
| 📁 `android` |
| 📄 `.metadata` |
| 📁 `.specstory` |
| 📄 `flutter.tar.xz` |
| 📁 `macos` |
| 📁 `test` |
| 📁 `web` |
| 📁 `windows` |
| 📄 `.cursorindexingignore` |
| 📄 `.gitattributes` |
| 📄 `.gitignore` |
| 📁 `linux` |

</details>

---

Read file: pubspec.yaml

---

<details>
            <summary>Listed directory undefined • **3** results</summary>
        
| Name |
|-------|
| 📄 `main.dart` |
| 📁 `ui` |
| 📁 `core` |

</details>

---

<details>
            <summary>Listed directory undefined • **4** results</summary>
        
| Name |
|-------|
| 📁 `components` |
| 📁 `pages` |
| 📁 `widgets` |
| 📁 `theme` |

</details>

---

<details>
            <summary>Listed directory undefined • **3** results</summary>
        
| Name |
|-------|
| 📁 `constants` |
| 📁 `models` |
| 📁 `providers` |

</details>

---

<details>
            <summary>Listed directory undefined • **12** results</summary>
        
| Name |
|-------|
| 📄 `home_page.dart` |
| 📄 `notification_test_page.dart` |
| 📄 `pdf_report_page.dart` |
| 📄 `producer_dashboard_page.dart` |
| 📄 `scan_page.dart` |
| 📄 `splash_page.dart` |
| 📄 `actions_page.dart` |
| 📄 `diagnosis_page.dart` |
| 📄 `history_page.dart` |
| 📄 `map_page.dart` |
| 📄 `report_page.dart` |
| 📄 `sentinel_page.dart` |

</details>

---

<details>
            <summary>Listed directory undefined • **2** results</summary>
        
| Name |
|-------|
| 📄 `notification_model.dart` |
| 📄 `plant_diagnosis.dart` |

</details>

---

Read file: lib/core/models/notification_model.dart

---

Read file: lib/ui/pages/producer_dashboard_page.dart

---

Read file: lib/main.dart

---

Read file: lib/core/providers/router_provider.dart

---

<details>
            <summary>Grep search for "undefined" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L24 | `bottomNavigationBarTheme: _buildBottomNavTheme(Brightness.light),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L48 | `bottomNavigationBarTheme: _buildBottomNavTheme(Brightness.dark),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L272 | `static BottomNavigationBarThemeData _buildBottomNavTheme(` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L275 | `return BottomNavigationBarThemeData(` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L285 | `type: BottomNavigationBarType.fixed,` |

</details>

---

Read file: lib/ui/pages/producer_dashboard_page.dart

---

Maintenant je vais créer les nouvelles fonctionnalités demandées. Commençons par l'historique des notifications et le profil producteur.

---

```diff
  
    // Producer routes
    static const String producerDashboard = '/producer/dashboard';
+   static const String producerProfile = '/producer/profile';
+   static const String notificationHistory = '/notifications/history';
    static const String pdfReport = '/pdf-report';
  
    // Test routes
```

---

Maintenant, créons le modèle de profil producteur :

---

```diff
+ class ProductionItem {
+   final String id;
+   final String type;
+   final String quantity;
+   final String season;
+   final ProductionStatus status;
+ 
+   ProductionItem({
+     required this.id,
+     required this.type,
+     required this.quantity,
+     required this.season,
+     required this.status,
+   });
+ 
+   factory ProductionItem.fromJson(Map<String, dynamic> json) {
+     return ProductionItem(
+       id: json['id'] ?? '',
+       type: json['type'] ?? '',
+       quantity: json['quantity'] ?? '',
+       season: json['season'] ?? '',
+       status: ProductionStatus.values.firstWhere(
+         (e) => e.name == json['status'],
+         orElse: () => ProductionStatus.enStock,
+       ),
+     );
+   }
+ 
+   Map<String, dynamic> toJson() {
+     return {
+       'id': id,
+       'type': type,
+       'quantity': quantity,
+       'season': season,
+       'status': status.name,
+     };
+   }
+ }
+ 
+ enum ProductionStatus {
+   enStock('En stock'),
+   vendu('Vendu'),
+   enCroissance('En croissance'),
+   recolte('Récolte');
+ 
+   const ProductionStatus(this.label);
+   final String label;
+ }
+ 
+ class ProducerProfile {
+   final String id;
+   final String fullName;
+   final String? profileImageUrl;
+   final String description;
+   final List<ProductionItem> productions;
+   final DateTime createdAt;
+   final DateTime updatedAt;
+ 
+   ProducerProfile({
+     required this.id,
+     required this.fullName,
+     this.profileImageUrl,
+     required this.description,
+     required this.productions,
+     required this.createdAt,
+     required this.updatedAt,
+   });
+ 
+   factory ProducerProfile.fromJson(Map<String, dynamic> json) {
+     return ProducerProfile(
+       id: json['id'] ?? '',
+       fullName: json['full_name'] ?? '',
+       profileImageUrl: json['profile_image_url'],
+       description: json['description'] ?? '',
+       productions: (json['productions'] as List<dynamic>?)
+               ?.map((item) => ProductionItem.fromJson(item))
+               .toList() ??
+           [],
+       createdAt: DateTime.parse(json['created_at'] ?? DateTime.now().toIso8601String()),
+       updatedAt: DateTime.parse(json['updated_at'] ?? DateTime.now().toIso8601String()),
+     );
+   }
+ 
+   Map<String, dynamic> toJson() {
+     return {
+       'id': id,
+       'full_name': fullName,
+       'profile_image_url': profileImageUrl,
+       'description': description,
+       'productions': productions.map((item) => item.toJson()).toList(),
+       'created_at': createdAt.toIso8601String(),
+       'updated_at': updatedAt.toIso8601String(),
+     };
+   }
+ 
+   ProducerProfile copyWith({
+     String? id,
+     String? fullName,
+     String? profileImageUrl,
+     String? description,
+     List<ProductionItem>? productions,
+     DateTime? createdAt,
+     DateTime? updatedAt,
+   }) {
+     return ProducerProfile(
+       id: id ?? this.id,
+       fullName: fullName ?? this.fullName,
+       profileImageUrl: profileImageUrl ?? this.profileImageUrl,
+       description: description ?? this.description,
+       productions: productions ?? this.productions,
+       createdAt: createdAt ?? this.createdAt,
+       updatedAt: updatedAt ?? this.updatedAt,
+     );
+   }
+ }
```

---

Maintenant, créons le provider pour gérer les notifications et le profil :

---

```diff
+ import 'package:flutter_riverpod/flutter_riverpod.dart';
+ import 'package:shared_preferences/shared_preferences.dart';
+ import 'dart:convert';
+ 
+ import '../models/notification_model.dart';
+ 
+ // Provider pour l'historique des notifications
+ final notificationHistoryProvider = StateNotifierProvider<NotificationHistoryNotifier, List<NotificationModel>>((ref) {
+   return NotificationHistoryNotifier();
+ });
+ 
+ class NotificationHistoryNotifier extends StateNotifier<List<NotificationModel>> {
+   NotificationHistoryNotifier() : super([]) {
+     _loadNotifications();
+   }
+ 
+   static const String _storageKey = 'notification_history';
+ 
+   // Charger les notifications depuis le stockage local
+   Future<void> _loadNotifications() async {
+     try {
+       final prefs = await SharedPreferences.getInstance();
+       final notificationsJson = prefs.getStringList(_storageKey);
+       
+       if (notificationsJson != null) {
+         final notifications = notificationsJson
+             .map((json) => NotificationModel.fromJson(jsonDecode(json)))
+             .toList();
+         
+         // Trier par timestamp décroissant (plus récent en premier)
+         notifications.sort((a, b) => b.timestamp.compareTo(a.timestamp));
+         state = notifications;
+       }
+     } catch (e) {
+       print('Erreur lors du chargement des notifications: $e');
+     }
+   }
+ 
+   // Sauvegarder les notifications dans le stockage local
+   Future<void> _saveNotifications() async {
+     try {
+       final prefs = await SharedPreferences.getInstance();
+       final notificationsJson = state
+           .map((notification) => jsonEncode(notification.toJson()))
+           .toList();
+       
+       await prefs.setStringList(_storageKey, notificationsJson);
+     } catch (e) {
+       print('Erreur lors de la sauvegarde des notifications: $e');
+     }
+   }
+ 
+   // Ajouter une nouvelle notification
+   Future<void> addNotification(NotificationModel notification) async {
+     // Éviter les doublons basés sur le timestamp
+     final exists = state.any((n) => n.timestamp == notification.timestamp);
+     if (!exists) {
+       state = [notification, ...state];
+       await _saveNotifications();
+     }
+   }
+ 
+   // Marquer toutes les notifications comme lues
+   Future<void> markAllAsRead() async {
+     // Pour l'instant, on ne fait rien car le modèle n'a pas de champ "lu"
+     // Cette méthode peut être étendue si nécessaire
+   }
+ 
+   // Supprimer une notification
+   Future<void> removeNotification(int timestamp) async {
+     state = state.where((n) => n.timestamp != timestamp).toList();
+     await _saveNotifications();
+   }
+ 
+   // Vider tout l'historique
+   Future<void> clearHistory() async {
+     state = [];
+     final prefs = await SharedPreferences.getInstance();
+     await prefs.remove(_storageKey);
+   }
+ 
+   // Obtenir le nombre de notifications non lues (simulation)
+   int get unreadCount => state.length > 5 ? 5 : 0; // Simulation simple
+ }
```

---

Créons le provider pour le profil producteur :

---

```diff
+ import 'package:flutter_riverpod/flutter_riverpod.dart';
+ import 'package:shared_preferences/shared_preferences.dart';
+ import 'dart:convert';
+ 
+ import '../models/producer_profile.dart';
+ 
+ // Provider pour le profil du producteur
+ final producerProfileProvider = StateNotifierProvider<ProducerProfileNotifier, ProducerProfile?>((ref) {
+   return ProducerProfileNotifier();
+ });
+ 
+ class ProducerProfileNotifier extends StateNotifier<ProducerProfile?> {
+   ProducerProfileNotifier() : super(null) {
+     _loadProfile();
+   }
+ 
+   static const String _storageKey = 'producer_profile';
+ 
+   // Charger le profil depuis le stockage local
+   Future<void> _loadProfile() async {
+     try {
+       final prefs = await SharedPreferences.getInstance();
+       final profileJson = prefs.getString(_storageKey);
+       
+       if (profileJson != null) {
+         final profile = ProducerProfile.fromJson(jsonDecode(profileJson));
+         state = profile;
+       } else {
+         // Créer un profil par défaut
+         state = _createDefaultProfile();
+         await _saveProfile();
+       }
+     } catch (e) {
+       print('Erreur lors du chargement du profil: $e');
+       state = _createDefaultProfile();
+     }
+   }
+ 
+   // Créer un profil par défaut
+   ProducerProfile _createDefaultProfile() {
+     return ProducerProfile(
+       id: 'producer_001',
+       fullName: 'Jean Dupont',
+       description: 'Producteur bio passionné depuis 15 ans, spécialisé dans les légumes de saison et les fruits rouges. Ferme familiale située dans la vallée de la Loire.',
+       productions: [
+         ProductionItem(
+           id: '1',
+           type: 'Tomates bio',
+           quantity: '500 kg/saison',
+           season: 'Été',
+           status: ProductionStatus.enStock,
+         ),
+         ProductionItem(
+           id: '2',
+           type: 'Courgettes',
+           quantity: '300 kg/saison',
+           season: 'Été',
+           status: ProductionStatus.enCroissance,
+         ),
+         ProductionItem(
+           id: '3',
+           type: 'Pommes de terre',
+           quantity: '1 tonne/saison',
+           season: 'Automne',
+           status: ProductionStatus.recolte,
+         ),
+         ProductionItem(
+           id: '4',
+           type: 'Fraises',
+           quantity: '200 kg/saison',
+           season: 'Printemps',
+           status: ProductionStatus.vendu,
+         ),
+       ],
+       createdAt: DateTime.now(),
+       updatedAt: DateTime.now(),
+     );
+   }
+ 
+   // Sauvegarder le profil dans le stockage local
+   Future<void> _saveProfile() async {
+     if (state == null) return;
+     
+     try {
+       final prefs = await SharedPreferences.getInstance();
+       final profileJson = jsonEncode(state!.toJson());
+       await prefs.setString(_storageKey, profileJson);
+     } catch (e) {
+       print('Erreur lors de la sauvegarde du profil: $e');
+     }
+   }
+ 
+   // Mettre à jour le profil
+   Future<void> updateProfile(ProducerProfile updatedProfile) async {
+     state = updatedProfile.copyWith(updatedAt: DateTime.now());
+     await _saveProfile();
+   }
+ 
+   // Mettre à jour uniquement les informations de base
+   Future<void> updateBasicInfo({
+     String? fullName,
+     String? description,
+     String? profileImageUrl,
+   }) async {
+     if (state == null) return;
+ 
+     state = state!.copyWith(
+       fullName: fullName ?? state!.fullName,
+       description: description ?? state!.description,
+       profileImageUrl: profileImageUrl ?? state!.profileImageUrl,
+       updatedAt: DateTime.now(),
+     );
+     await _saveProfile();
+   }
+ 
+   // Ajouter une nouvelle production
+   Future<void> addProduction(ProductionItem production) async {
+     if (state == null) return;
+ 
+     final updatedProductions = [...state!.productions, production];
+     state = state!.copyWith(
+       productions: updatedProductions,
+       updatedAt: DateTime.now(),
+     );
+     await _saveProfile();
+   }
+ 
+   // Mettre à jour une production existante
+   Future<void> updateProduction(ProductionItem updatedProduction) async {
+     if (state == null) return;
+ 
+     final updatedProductions = state!.productions.map((production) {
+       return production.id == updatedProduction.id ? updatedProduction : production;
+     }).toList();
+ 
+     state = state!.copyWith(
+       productions: updatedProductions,
+       updatedAt: DateTime.now(),
+     );
+     await _saveProfile();
+   }
+ 
+   // Supprimer une production
+   Future<void> removeProduction(String productionId) async {
+     if (state == null) return;
+ 
+     final updatedProductions = state!.productions
+         .where((production) => production.id != productionId)
+         .toList();
+ 
+     state = state!.copyWith(
+       productions: updatedProductions,
+       updatedAt: DateTime.now(),
+     );
+     await _saveProfile();
+   }
+ 
+   // Réinitialiser le profil
+   Future<void> resetProfile() async {
+     state = _createDefaultProfile();
+     await _saveProfile();
+   }
+ }
```

---

Maintenant, créons la page d'historique des notifications :

---

```diff
+ import 'package:flutter/material.dart';
+ import 'package:flutter_riverpod/flutter_riverpod.dart';
+ import 'package:flutter_animate/flutter_animate.dart';
+ import 'package:go_router/go_router.dart';
+ import 'package:intl/intl.dart';
+ import 'package:just_audio/just_audio.dart';
+ import 'package:phosphor_flutter/phosphor_flutter.dart';
+ 
+ import '../../core/constants/app_colors.dart';
+ import '../../core/models/notification_model.dart';
+ import '../../core/providers/notification_provider.dart';
+ 
+ class NotificationHistoryPage extends ConsumerStatefulWidget {
+   const NotificationHistoryPage({super.key});
+ 
+   @override
+   ConsumerState<NotificationHistoryPage> createState() => _NotificationHistoryPageState();
+ }
+ 
+ class _NotificationHistoryPageState extends ConsumerState<NotificationHistoryPage>
+     with TickerProviderStateMixin {
+   late AnimationController _animationController;
+   AudioPlayer? _audioPlayer;
+   String? _currentPlayingAudio;
+ 
+   @override
+   void initState() {
+     super.initState();
+     _animationController = AnimationController(
+       duration: const Duration(milliseconds: 1200),
+       vsync: this,
+     );
+     _audioPlayer = AudioPlayer();
+     _animationController.forward();
+   }
+ 
+   @override
+   void dispose() {
+     _animationController.dispose();
+     _audioPlayer?.dispose();
+     super.dispose();
+   }
+ 
+   @override
+   Widget build(BuildContext context) {
+     final notifications = ref.watch(notificationHistoryProvider);
+ 
+     return Scaffold(
+       backgroundColor: AppColors.backgroundLight,
+       appBar: AppBar(
+         title: const Text(
+           'Historique des notifications',
+           style: TextStyle(fontWeight: FontWeight.w600),
+         ),
+         backgroundColor: Colors.transparent,
+         elevation: 0,
+         leading: IconButton(
+           icon: const Icon(Icons.arrow_back_ios),
+           onPressed: () => context.pop(),
+         ),
+         actions: [
+           if (notifications.isNotEmpty)
+             IconButton(
+               icon: const Icon(PhosphorIcons.trash),
+               onPressed: () => _showClearConfirmation(),
+               tooltip: 'Vider l\'historique',
+             ),
+         ],
+       ),
+       body: notifications.isEmpty
+           ? _buildEmptyState()
+           : RefreshIndicator(
+               onRefresh: () async {
+                 // Simuler un rafraîchissement
+                 await Future.delayed(const Duration(seconds: 1));
+               },
+               child: ListView.builder(
+                 padding: const EdgeInsets.all(16),
+                 itemCount: notifications.length,
+                 itemBuilder: (context, index) {
+                   final notification = notifications[index];
+                   return _buildNotificationCard(notification, index)
+                       .animate()
+                       .slideX(
+                         begin: 1.0,
+                         duration: Duration(milliseconds: 300 + (index * 100)),
+                         curve: Curves.easeOutCubic,
+                       )
+                       .fadeIn(
+                         duration: Duration(milliseconds: 400 + (index * 100)),
+                       );
+                 },
+               ),
+             ),
+     );
+   }
+ 
+   Widget _buildEmptyState() {
+     return Center(
+       child: Column(
+         mainAxisAlignment: MainAxisAlignment.center,
+         children: [
+           Container(
+             width: 120,
+             height: 120,
+             decoration: BoxDecoration(
+               color: AppColors.primaryGreen.withOpacity(0.1),
+               shape: BoxShape.circle,
+             ),
+             child: const Icon(
+               PhosphorIcons.bellSlash,
+               size: 60,
+               color: AppColors.primaryGreen,
+             ),
+           )
+               .animate()
+               .scale(
+                 delay: const Duration(milliseconds: 200),
+                 duration: const Duration(milliseconds: 600),
+                 curve: Curves.elasticOut,
+               )
+               .fadeIn(),
+           const SizedBox(height: 24),
+           Text(
+             'Aucune notification',
+             style: Theme.of(context).textTheme.headlineSmall?.copyWith(
+                   fontWeight: FontWeight.w600,
+                   color: Colors.grey[800],
+                 ),
+           )
+               .animate()
+               .fadeIn(delay: const Duration(milliseconds: 400))
+               .slideY(begin: 0.3, end: 0),
+           const SizedBox(height: 12),
+           Text(
+             'Vos notifications apparaîtront ici\nune fois que vous en recevrez.',
+             textAlign: TextAlign.center,
+             style: Theme.of(context).textTheme.bodyLarge?.copyWith(
+                   color: Colors.grey[600],
+                   height: 1.5,
+                 ),
+           )
+               .animate()
+               .fadeIn(delay: const Duration(milliseconds: 600))
+               .slideY(begin: 0.3, end: 0),
+         ],
+       ),
+     );
+   }
+ 
+   Widget _buildNotificationCard(NotificationModel notification, int index) {
+     final isPlaying = _currentPlayingAudio == notification.audioFile;
+ 
+     return Container(
+       margin: const EdgeInsets.only(bottom: 16),
+       decoration: BoxDecoration(
+         color: Colors.white,
+         borderRadius: BorderRadius.circular(16),
+         boxShadow: [
+           BoxShadow(
+             color: Colors.black.withOpacity(0.05),
+             blurRadius: 10,
+             offset: const Offset(0, 4),
+           ),
+         ],
+       ),
+       child: Material(
+         color: Colors.transparent,
+         child: InkWell(
+           borderRadius: BorderRadius.circular(16),
+           onTap: () => _playAudio(notification),
+           child: Padding(
+             padding: const EdgeInsets.all(20),
+             child: Column(
+               crossAxisAlignment: CrossAxisAlignment.start,
+               children: [
+                 Row(
+                   crossAxisAlignment: CrossAxisAlignment.start,
+                   children: [
+                     // Icône de notification
+                     Container(
+                       width: 48,
+                       height: 48,
+                       decoration: BoxDecoration(
+                         color: AppColors.primaryGreen.withOpacity(0.1),
+                         borderRadius: BorderRadius.circular(12),
+                       ),
+                       child: const Icon(
+                         PhosphorIcons.bell,
+                         color: AppColors.primaryGreen,
+                         size: 24,
+                       ),
+                     ),
+                     const SizedBox(width: 16),
+                     
+                     // Contenu principal
+                     Expanded(
+                       child: Column(
+                         crossAxisAlignment: CrossAxisAlignment.start,
+                         children: [
+                           Text(
+                             notification.titre,
+                             style: Theme.of(context).textTheme.titleMedium?.copyWith(
+                                   fontWeight: FontWeight.w600,
+                                   color: Colors.grey[900],
+                                 ),
+                             maxLines: 2,
+                             overflow: TextOverflow.ellipsis,
+                           ),
+                           const SizedBox(height: 8),
+                           Text(
+                             notification.message,
+                             style: Theme.of(context).textTheme.bodyMedium?.copyWith(
+                                   color: Colors.grey[700],
+                                   height: 1.4,
+                                 ),
+                             maxLines: 3,
+                             overflow: TextOverflow.ellipsis,
+                           ),
+                           const SizedBox(height: 12),
+                           Text(
+                             _formatTimestamp(notification.timestamp),
+                             style: Theme.of(context).textTheme.bodySmall?.copyWith(
+                                   color: Colors.grey[500],
+                                   fontWeight: FontWeight.w500,
+                                 ),
+                           ),
+                         ],
+                       ),
+                     ),
+                     
+                     // Bouton audio
+                     Container(
+                       width: 48,
+                       height: 48,
+                       decoration: BoxDecoration(
+                         color: isPlaying
+                             ? AppColors.primaryGreen
+                             : AppColors.primaryGreen.withOpacity(0.1),
+                         borderRadius: BorderRadius.circular(12),
+                       ),
+                       child: Material(
+                         color: Colors.transparent,
+                         child: InkWell(
+                           borderRadius: BorderRadius.circular(12),
+                           onTap: () => _playAudio(notification),
+                           child: Icon(
+                             isPlaying ? PhosphorIcons.pause : PhosphorIcons.play,
+                             color: isPlaying ? Colors.white : AppColors.primaryGreen,
+                             size: 20,
+                           ),
+                         ),
+                       ),
+                     ),
+                   ],
+                 ),
+               ],
+             ),
+           ),
+         ),
+       ),
+     );
+   }
+ 
+   String _formatTimestamp(int timestamp) {
+     final date = DateTime.fromMillisecondsSinceEpoch(timestamp * 1000);
+     final now = DateTime.now();
+     final difference = now.difference(date);
+ 
+     if (difference.inDays == 0) {
+       return 'Aujourd\'hui à ${DateFormat('HH:mm').format(date)}';
+     } else if (difference.inDays == 1) {
+       return 'Hier à ${DateFormat('HH:mm').format(date)}';
+     } else if (difference.inDays < 7) {
+       return '${DateFormat('EEEE', 'fr_FR').format(date)} à ${DateFormat('HH:mm').format(date)}';
+     } else {
+       return DateFormat('dd/MM/yyyy à HH:mm').format(date);
+     }
+   }
+ 
+   Future<void> _playAudio(NotificationModel notification) async {
+     try {
+       if (_currentPlayingAudio == notification.audioFile) {
+         // Si c'est déjà en cours de lecture, on met en pause
+         await _audioPlayer?.pause();
+         setState(() {
+           _currentPlayingAudio = null;
+         });
+       } else {
+         // Jouer le nouveau fichier audio
+         final audioUrl = notification.getAudioUrl('http://localhost:8000');
+         await _audioPlayer?.setUrl(audioUrl);
+         await _audioPlayer?.play();
+         
+         setState(() {
+           _currentPlayingAudio = notification.audioFile;
+         });
+ 
+         // Écouter la fin de la lecture
+         _audioPlayer?.playerStateStream.listen((state) {
+           if (state.processingState == ProcessingState.completed) {
+             setState(() {
+               _currentPlayingAudio = null;
+             });
+           }
+         });
+       }
+     } catch (e) {
+       print('Erreur lors de la lecture audio: $e');
+       ScaffoldMessenger.of(context).showSnackBar(
+         const SnackBar(
+           content: Text('Impossible de lire le fichier audio'),
+           backgroundColor: Colors.red,
+         ),
+       );
+     }
+   }
+ 
+   void _showClearConfirmation() {
+     showDialog(
+       context: context,
+       builder: (context) => AlertDialog(
+         shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
+         title: const Text('Vider l\'historique'),
+         content: const Text(
+           'Êtes-vous sûr de vouloir supprimer toutes les notifications ? Cette action est irréversible.',
+         ),
+         actions: [
+           TextButton(
+             onPressed: () => Navigator.of(context).pop(),
+             child: const Text('Annuler'),
+           ),
+           ElevatedButton(
+             onPressed: () {
+               ref.read(notificationHistoryProvider.notifier).clearHistory();
+               Navigator.of(context).pop();
+               ScaffoldMessenger.of(context).showSnackBar(
+                 const SnackBar(
+                   content: Text('Historique vidé'),
+                   backgroundColor: AppColors.primaryGreen,
+                 ),
+               );
+             },
+             style: ElevatedButton.styleFrom(
+               backgroundColor: Colors.red,
+               foregroundColor: Colors.white,
+             ),
+             child: const Text('Vider'),
+           ),
+         ],
+       ),
+     );
+   }
+ }
```

---

Maintenant, créons la page de profil producteur :

---

```diff
+ import 'package:flutter/material.dart';
+ import 'package:flutter_riverpod/flutter_riverpod.dart';
+ import 'package:flutter_animate/flutter_animate.dart';
+ import 'package:go_router/go_router.dart';
+ import 'package:phosphor_flutter/phosphor_flutter.dart';
+ import 'package:image_picker/image_picker.dart';
+ import 'dart:io';
+ 
+ import '../../core/constants/app_colors.dart';
+ import '../../core/models/producer_profile.dart';
+ import '../../core/providers/producer_profile_provider.dart';
+ 
+ class ProducerProfilePage extends ConsumerStatefulWidget {
+   const ProducerProfilePage({super.key});
+ 
+   @override
+   ConsumerState<ProducerProfilePage> createState() => _ProducerProfilePageState();
+ }
+ 
+ class _ProducerProfilePageState extends ConsumerState<ProducerProfilePage>
+     with TickerProviderStateMixin {
+   late AnimationController _animationController;
+   final _formKey = GlobalKey<FormState>();
+   final _nameController = TextEditingController();
+   final _descriptionController = TextEditingController();
+   bool _isEditing = false;
+ 
+   @override
+   void initState() {
+     super.initState();
+     _animationController = AnimationController(
+       duration: const Duration(milliseconds: 1200),
+       vsync: this,
+     );
+     _animationController.forward();
+   }
+ 
+   @override
+   void dispose() {
+     _animationController.dispose();
+     _nameController.dispose();
+     _descriptionController.dispose();
+     super.dispose();
+   }
+ 
+   @override
+   Widget build(BuildContext context) {
+     final profile = ref.watch(producerProfileProvider);
+ 
+     if (profile == null) {
+       return const Scaffold(
+         body: Center(child: CircularProgressIndicator()),
+       );
+     }
+ 
+     // Mettre à jour les contrôleurs quand le profil change
+     if (!_isEditing) {
+       _nameController.text = profile.fullName;
+       _descriptionController.text = profile.description;
+     }
+ 
+     return Scaffold(
+       backgroundColor: AppColors.backgroundLight,
+       body: CustomScrollView(
+         slivers: [
+           _buildSliverAppBar(profile),
+           SliverToBoxAdapter(
+             child: Padding(
+               padding: const EdgeInsets.all(16),
+               child: Column(
+                 children: [
+                   _buildProfileInfo(profile),
+                   const SizedBox(height: 24),
+                   _buildProductionsSection(profile),
+                 ],
+               ),
+             ),
+           ),
+         ],
+       ),
+     );
+   }
+ 
+   Widget _buildSliverAppBar(ProducerProfile profile) {
+     return SliverAppBar(
+       expandedHeight: 280,
+       floating: false,
+       pinned: true,
+       backgroundColor: AppColors.primaryGreen,
+       leading: IconButton(
+         icon: const Icon(Icons.arrow_back_ios, color: Colors.white),
+         onPressed: () => context.pop(),
+       ),
+       actions: [
+         IconButton(
+           icon: Icon(_isEditing ? PhosphorIcons.check : PhosphorIcons.pencil,
+               color: Colors.white),
+           onPressed: () => _toggleEditing(profile),
+         ),
+       ],
+       flexibleSpace: FlexibleSpaceBar(
+         background: Container(
+           decoration: const BoxDecoration(
+             gradient: LinearGradient(
+               begin: Alignment.topCenter,
+               end: Alignment.bottomCenter,
+               colors: [
+                 AppColors.primaryGreen,
+                 Color(0xFF2E7D32),
+               ],
+             ),
+           ),
+           child: Column(
+             mainAxisAlignment: MainAxisAlignment.center,
+             children: [
+               const SizedBox(height: 40),
+               _buildProfileAvatar(profile),
+               const SizedBox(height: 16),
+               Text(
+                 profile.fullName,
+                 style: const TextStyle(
+                   fontSize: 24,
+                   fontWeight: FontWeight.bold,
+                   color: Colors.white,
+                 ),
+               )
+                   .animate()
+                   .fadeIn(delay: const Duration(milliseconds: 300))
+                   .slideY(begin: 0.3, end: 0),
+               const SizedBox(height: 8),
+               const Text(
+                 'Producteur Bio Certifié',
+                 style: TextStyle(
+                   fontSize: 16,
+                   color: Colors.white70,
+                   fontWeight: FontWeight.w500,
+                 ),
+               )
+                   .animate()
+                   .fadeIn(delay: const Duration(milliseconds: 500))
+                   .slideY(begin: 0.3, end: 0),
+             ],
+           ),
+         ),
+       ),
+     );
+   }
+ 
+   Widget _buildProfileAvatar(ProducerProfile profile) {
+     return Stack(
+       children: [
+         Container(
+           width: 100,
+           height: 100,
+           decoration: BoxDecoration(
+             shape: BoxShape.circle,
+             border: Border.all(color: Colors.white, width: 4),
+             boxShadow: [
+               BoxShadow(
+                 color: Colors.black.withOpacity(0.2),
+                 blurRadius: 10,
+                 offset: const Offset(0, 4),
+               ),
+             ],
+           ),
+           child: CircleAvatar(
+             radius: 46,
+             backgroundColor: Colors.white,
+             backgroundImage: profile.profileImageUrl != null
+                 ? NetworkImage(profile.profileImageUrl!)
+                 : null,
+             child: profile.profileImageUrl == null
+                 ? const Icon(
+                     PhosphorIcons.user,
+                     size: 50,
+                     color: AppColors.primaryGreen,
+                   )
+                 : null,
+           ),
+         )
+             .animate()
+             .scale(
+               delay: const Duration(milliseconds: 200),
+               duration: const Duration(milliseconds: 600),
+               curve: Curves.elasticOut,
+             )
+             .fadeIn(),
+         if (_isEditing)
+           Positioned(
+             bottom: 0,
+             right: 0,
+             child: Container(
+               width: 32,
+               height: 32,
+               decoration: const BoxDecoration(
+                 color: Colors.white,
+                 shape: BoxShape.circle,
+               ),
+               child: IconButton(
+                 padding: EdgeInsets.zero,
+                 icon: const Icon(PhosphorIcons.camera, size: 16),
+                 onPressed: _pickImage,
+               ),
+             ),
+           ),
+       ],
+     );
+   }
+ 
+   Widget _buildProfileInfo(ProducerProfile profile) {
+     return Container(
+       decoration: BoxDecoration(
+         color: Colors.white,
+         borderRadius: BorderRadius.circular(16),
+         boxShadow: [
+           BoxShadow(
+             color: Colors.black.withOpacity(0.05),
+             blurRadius: 10,
+             offset: const Offset(0, 4),
+           ),
+         ],
+       ),
+       child: Padding(
+         padding: const EdgeInsets.all(20),
+         child: Form(
+           key: _formKey,
+           child: Column(
+             crossAxisAlignment: CrossAxisAlignment.start,
+             children: [
+               Row(
+                 children: [
+                   const Icon(PhosphorIcons.user, color: AppColors.primaryGreen),
+                   const SizedBox(width: 12),
+                   Text(
+                     'Informations personnelles',
+                     style: Theme.of(context).textTheme.titleLarge?.copyWith(
+                           fontWeight: FontWeight.w600,
+                         ),
+                   ),
+                 ],
+               ),
+               const SizedBox(height: 20),
+               
+               // Nom complet
+               TextFormField(
+                 controller: _nameController,
+                 enabled: _isEditing,
+                 decoration: InputDecoration(
+                   labelText: 'Nom complet',
+                   prefixIcon: const Icon(PhosphorIcons.identification),
+                   border: OutlineInputBorder(
+                     borderRadius: BorderRadius.circular(12),
+                   ),
+                 ),
+                 validator: (value) {
+                   if (value == null || value.isEmpty) {
+                     return 'Le nom est requis';
+                   }
+                   return null;
+                 },
+               ),
+               const SizedBox(height: 16),
+               
+               // Description
+               TextFormField(
+                 controller: _descriptionController,
+                 enabled: _isEditing,
+                 maxLines: 4,
+                 decoration: InputDecoration(
+                   labelText: 'Présentation',
+                   prefixIcon: const Icon(PhosphorIcons.textAlignLeft),
+                   border: OutlineInputBorder(
+                     borderRadius: BorderRadius.circular(12),
+                   ),
+                   alignLabelWithHint: true,
+                 ),
+                 validator: (value) {
+                   if (value == null || value.isEmpty) {
+                     return 'La présentation est requise';
+                   }
+                   return null;
+                 },
+               ),
+             ],
+           ),
+         ),
+       ),
+     )
+         .animate()
+         .fadeIn(delay: const Duration(milliseconds: 400))
+         .slideY(begin: 0.3, end: 0);
+   }
+ 
+   Widget _buildProductionsSection(ProducerProfile profile) {
+     return Container(
+       decoration: BoxDecoration(
+         color: Colors.white,
+         borderRadius: BorderRadius.circular(16),
+         boxShadow: [
+           BoxShadow(
+             color: Colors.black.withOpacity(0.05),
+             blurRadius: 10,
+             offset: const Offset(0, 4),
+           ),
+         ],
+       ),
+       child: Padding(
+         padding: const EdgeInsets.all(20),
+         child: Column(
+           crossAxisAlignment: CrossAxisAlignment.start,
+           children: [
+             Row(
+               mainAxisAlignment: MainAxisAlignment.spaceBetween,
+               children: [
+                 Row(
+                   children: [
+                     const Icon(PhosphorIcons.plant, color: AppColors.primaryGreen),
+                     const SizedBox(width: 12),
+                     Text(
+                       'Productions agricoles',
+                       style: Theme.of(context).textTheme.titleLarge?.copyWith(
+                             fontWeight: FontWeight.w600,
+                           ),
+                     ),
+                   ],
+                 ),
+                 if (_isEditing)
+                   IconButton(
+                     icon: const Icon(PhosphorIcons.plus, color: AppColors.primaryGreen),
+                     onPressed: () => _showAddProductionDialog(profile),
+                   ),
+               ],
+             ),
+             const SizedBox(height: 16),
+             
+             if (profile.productions.isEmpty)
+               _buildEmptyProductions()
+             else
+               ...profile.productions.asMap().entries.map((entry) {
+                 final index = entry.key;
+                 final production = entry.value;
+                 return _buildProductionCard(production, index, profile);
+               }),
+           ],
+         ),
+       ),
+     )
+         .animate()
+         .fadeIn(delay: const Duration(milliseconds: 600))
+         .slideY(begin: 0.3, end: 0);
+   }
+ 
+   Widget _buildEmptyProductions() {
+     return Container(
+       padding: const EdgeInsets.all(32),
+       child: Column(
+         children: [
+           Icon(
+             PhosphorIcons.plant,
+             size: 48,
+             color: Colors.grey[400],
+           ),
+           const SizedBox(height: 16),
+           Text(
+             'Aucune production',
+             style: Theme.of(context).textTheme.titleMedium?.copyWith(
+                   color: Colors.grey[600],
+                   fontWeight: FontWeight.w500,
+                 ),
+           ),
+           const SizedBox(height: 8),
+           Text(
+             'Ajoutez vos productions pour compléter votre profil',
+             textAlign: TextAlign.center,
+             style: Theme.of(context).textTheme.bodyMedium?.copyWith(
+                   color: Colors.grey[500],
+                 ),
+           ),
+         ],
+       ),
+     );
+   }
+ 
+   Widget _buildProductionCard(ProductionItem production, int index, ProducerProfile profile) {
+     return Container(
+       margin: const EdgeInsets.only(bottom: 12),
+       decoration: BoxDecoration(
+         color: AppColors.primaryGreen.withOpacity(0.05),
+         borderRadius: BorderRadius.circular(12),
+         border: Border.all(
+           color: AppColors.primaryGreen.withOpacity(0.2),
+         ),
+       ),
+       child: Padding(
+         padding: const EdgeInsets.all(16),
+         child: Row(
+           children: [
+             Container(
+               width: 48,
+               height: 48,
+               decoration: BoxDecoration(
+                 color: _getStatusColor(production.status).withOpacity(0.2),
+                 borderRadius: BorderRadius.circular(12),
+               ),
+               child: Icon(
+                 _getStatusIcon(production.status),
+                 color: _getStatusColor(production.status),
+                 size: 24,
+               ),
+             ),
+             const SizedBox(width: 16),
+             
+             Expanded(
+               child: Column(
+                 crossAxisAlignment: CrossAxisAlignment.start,
+                 children: [
+                   Text(
+                     production.type,
+                     style: Theme.of(context).textTheme.titleMedium?.copyWith(
+                           fontWeight: FontWeight.w600,
+                         ),
+                   ),
+                   const SizedBox(height: 4),
+                   Text(
+                     '${production.quantity} • ${production.season}',
+                     style: Theme.of(context).textTheme.bodyMedium?.copyWith(
+                           color: Colors.grey[600],
+                         ),
+                   ),
+                   const SizedBox(height: 8),
+                   Container(
+                     padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
+                     decoration: BoxDecoration(
+                       color: _getStatusColor(production.status),
+                       borderRadius: BorderRadius.circular(6),
+                     ),
+                     child: Text(
+                       production.status.label,
+                       style: const TextStyle(
+                         color: Colors.white,
+                         fontSize: 12,
+                         fontWeight: FontWeight.w500,
+                       ),
+                     ),
+                   ),
+                 ],
+               ),
+             ),
+             
+             if (_isEditing)
+               PopupMenuButton(
+                 icon: const Icon(PhosphorIcons.dotsThreeVertical),
+                 itemBuilder: (context) => [
+                   PopupMenuItem(
+                     child: const Row(
+                       children: [
+                         Icon(PhosphorIcons.pencil, size: 16),
+                         SizedBox(width: 8),
+                         Text('Modifier'),
+                       ],
+                     ),
+                     onTap: () => _showEditProductionDialog(production, profile),
+                   ),
+                   PopupMenuItem(
+                     child: const Row(
+                       children: [
+                         Icon(PhosphorIcons.trash, size: 16, color: Colors.red),
+                         SizedBox(width: 8),
+                         Text('Supprimer', style: TextStyle(color: Colors.red)),
+                       ],
+                     ),
+                     onTap: () => _removeProduction(production.id),
+                   ),
+                 ],
+               ),
+           ],
+         ),
+       ),
+     )
+         .animate()
+         .fadeIn(delay: Duration(milliseconds: 200 + (index * 100)))
+         .slideX(begin: 1.0, end: 0.0);
+   }
+ 
+   Color _getStatusColor(ProductionStatus status) {
+     switch (status) {
+       case ProductionStatus.enStock:
+         return Colors.green;
+       case ProductionStatus.vendu:
+         return Colors.blue;
+       case ProductionStatus.enCroissance:
+         return Colors.orange;
+       case ProductionStatus.recolte:
+         return Colors.purple;
+     }
+   }
+ 
+   IconData _getStatusIcon(ProductionStatus status) {
+     switch (status) {
+       case ProductionStatus.enStock:
+         return PhosphorIcons.package;
+       case ProductionStatus.vendu:
+         return PhosphorIcons.handshake;
+       case ProductionStatus.enCroissance:
+         return PhosphorIcons.plant;
+       case ProductionStatus.recolte:
+         return PhosphorIcons.basket;
+     }
+   }
+ 
+   void _toggleEditing(ProducerProfile profile) {
+     if (_isEditing) {
+       // Sauvegarder les modifications
+       if (_formKey.currentState!.validate()) {
+         ref.read(producerProfileProvider.notifier).updateBasicInfo(
+               fullName: _nameController.text,
+               description: _descriptionController.text,
+             );
+         setState(() {
+           _isEditing = false;
+         });
+         ScaffoldMessenger.of(context).showSnackBar(
+           const SnackBar(
+             content: Text('Profil mis à jour'),
+             backgroundColor: AppColors.primaryGreen,
+           ),
+         );
+       }
+     } else {
+       setState(() {
+         _isEditing = true;
+       });
+     }
+   }
+ 
+   Future<void> _pickImage() async {
+     final picker = ImagePicker();
+     final image = await picker.pickImage(source: ImageSource.gallery);
+     
+     if (image != null) {
+       // Ici, vous pourriez uploader l'image vers un serveur
+       // Pour cet exemple, on simule juste la mise à jour
+       ref.read(producerProfileProvider.notifier).updateBasicInfo(
+             profileImageUrl: image.path, // En réalité, ce serait une URL
+           );
+     }
+   }
+ 
+   void _showAddProductionDialog(ProducerProfile profile) {
+     _showProductionDialog(null, profile);
+   }
+ 
+   void _showEditProductionDialog(ProductionItem production, ProducerProfile profile) {
+     _showProductionDialog(production, profile);
+   }
+ 
+   void _showProductionDialog(ProductionItem? production, ProducerProfile profile) {
+     final typeController = TextEditingController(text: production?.type ?? '');
+     final quantityController = TextEditingController(text: production?.quantity ?? '');
+     final seasonController = TextEditingController(text: production?.season ?? '');
+     ProductionStatus selectedStatus = production?.status ?? ProductionStatus.enCroissance;
+ 
+     showDialog(
+       context: context,
+       builder: (context) => AlertDialog(
+         shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
+         title: Text(production == null ? 'Ajouter une production' : 'Modifier la production'),
+         content: SingleChildScrollView(
+           child: Column(
+             mainAxisSize: MainAxisSize.min,
+             children: [
+               TextField(
+                 controller: typeController,
+                 decoration: const InputDecoration(
+                   labelText: 'Type de culture',
+                   border: OutlineInputBorder(),
+                 ),
+               ),
+               const SizedBox(height: 16),
+               TextField(
+                 controller: quantityController,
+                 decoration: const InputDecoration(
+                   labelText: 'Quantité moyenne',
+                   border: OutlineInputBorder(),
+                 ),
+               ),
+               const SizedBox(height: 16),
+               TextField(
+                 controller: seasonController,
+                 decoration: const InputDecoration(
+                   labelText: 'Saison',
+                   border: OutlineInputBorder(),
+                 ),
+               ),
+               const SizedBox(height: 16),
+               StatefulBuilder(
+                 builder: (context, setState) => DropdownButtonFormField<ProductionStatus>(
+                   value: selectedStatus,
+                   decoration: const InputDecoration(
+                     labelText: 'Statut',
+                     border: OutlineInputBorder(),
+                   ),
+                   items: ProductionStatus.values.map((status) {
+                     return DropdownMenuItem(
+                       value: status,
+                       child: Text(status.label),
+                     );
+                   }).toList(),
+                   onChanged: (value) {
+                     if (value != null) {
+                       setState(() {
+                         selectedStatus = value;
+                       });
+                     }
+                   },
+                 ),
+               ),
+             ],
+           ),
+         ),
+         actions: [
+           TextButton(
+             onPressed: () => Navigator.of(context).pop(),
+             child: const Text('Annuler'),
+           ),
+           ElevatedButton(
+             onPressed: () {
+               final newProduction = ProductionItem(
+                 id: production?.id ?? DateTime.now().millisecondsSinceEpoch.toString(),
+                 type: typeController.text,
+                 quantity: quantityController.text,
+                 season: seasonController.text,
+                 status: selectedStatus,
+               );
+ 
+               if (production == null) {
+                 ref.read(producerProfileProvider.notifier).addProduction(newProduction);
+               } else {
+                 ref.read(producerProfileProvider.notifier).updateProduction(newProduction);
+               }
+ 
+               Navigator.of(context).pop();
+             },
+             child: Text(production == null ? 'Ajouter' : 'Modifier'),
+           ),
+         ],
+       ),
+     );
+   }
+ 
+   void _removeProduction(String productionId) {
+     ref.read(producerProfileProvider.notifier).removeProduction(productionId);
+   }
+ }
```

---

Maintenant, ajoutons les nouvelles routes au routeur :

---



---



---

Maintenant, ajoutons une navigation bottom au dashboard producteur pour inclure le profil :

---

Read file: lib/ui/pages/producer_dashboard_page.dart

---

Créons un widget de navigation bottom pour le dashboard producteur :

---

```diff
+ import 'package:flutter/material.dart';
+ import 'package:go_router/go_router.dart';
+ import 'package:phosphor_flutter/phosphor_flutter.dart';
+ 
+ import '../../core/constants/app_colors.dart';
+ 
+ class ProducerBottomNav extends StatelessWidget {
+   final int currentIndex;
+ 
+   const ProducerBottomNav({
+     super.key,
+     required this.currentIndex,
+   });
+ 
+   @override
+   Widget build(BuildContext context) {
+     return Container(
+       decoration: BoxDecoration(
+         color: Colors.white,
+         borderRadius: const BorderRadius.only(
+           topLeft: Radius.circular(20),
+           topRight: Radius.circular(20),
+         ),
+         boxShadow: [
+           BoxShadow(
+             color: Colors.black.withOpacity(0.1),
+             blurRadius: 20,
+             offset: const Offset(0, -5),
+           ),
+         ],
+       ),
+       child: ClipRRect(
+         borderRadius: const BorderRadius.only(
+           topLeft: Radius.circular(20),
+           topRight: Radius.circular(20),
+         ),
+         child: BottomNavigationBar(
+           currentIndex: currentIndex,
+           type: BottomNavigationBarType.fixed,
+           backgroundColor: Colors.white,
+           selectedItemColor: AppColors.primaryGreen,
+           unselectedItemColor: Colors.grey[400],
+           selectedFontSize: 12,
+           unselectedFontSize: 12,
+           iconSize: 24,
+           elevation: 0,
+           items: const [
+             BottomNavigationBarItem(
+               icon: Icon(PhosphorIcons.chartLineUp),
+               activeIcon: Icon(PhosphorIcons.chartLineUpFill),
+               label: 'Dashboard',
+             ),
+             BottomNavigationBarItem(
+               icon: Icon(PhosphorIcons.bell),
+               activeIcon: Icon(PhosphorIcons.bellFill),
+               label: 'Notifications',
+             ),
+             BottomNavigationBarItem(
+               icon: Icon(PhosphorIcons.user),
+               activeIcon: Icon(PhosphorIcons.userFill),
+               label: 'Profil',
+             ),
+           ],
+           onTap: (index) => _onItemTapped(context, index),
+         ),
+       ),
+     );
+   }
+ 
+   void _onItemTapped(BuildContext context, int index) {
+     if (index == currentIndex) return;
+ 
+     switch (index) {
+       case 0:
+         context.go('/producer/dashboard');
+         break;
+       case 1:
+         context.push('/notifications/history');
+         break;
+       case 2:
+         context.push('/producer/profile');
+         break;
+     }
+   }
+ }
```

---

Maintenant, modifions le dashboard producteur pour inclure la navigation bottom :

---



---



---



---

Maintenant ajoutons la navigation aux nouvelles pages. Commençons par modifier la page de profil pour inclure la navigation :

---



---



---

Créons maintenant quelques notifications d'exemple pour tester la fonctionnalité :

---

```diff
  
    // Obtenir le nombre de notifications non lues (simulation)
    int get unreadCount => state.length > 5 ? 5 : 0; // Simulation simple
+ 
+   // Ajouter des notifications d'exemple pour les tests
+   Future<void> addSampleNotifications() async {
+     final now = DateTime.now();
+     final samples = [
+       NotificationModel(
+         audioFile: 'alert_parasite_tomate.mp3',
+         message: 'Parasites détectés sur vos plants de tomates. Intervention recommandée dans les 24h.',
+         timestamp: now.subtract(const Duration(hours: 2)).millisecondsSinceEpoch ~/ 1000,
+         titre: 'Alerte Parasites Détectés',
+       ),
+       NotificationModel(
+         audioFile: 'irrigation_recommandee.mp3',
+         message: 'Le niveau d\'humidité du sol est bas. Irrigation recommandée pour la parcelle B.',
+         timestamp: now.subtract(const Duration(hours: 5)).millisecondsSinceEpoch ~/ 1000,
+         titre: 'Irrigation Recommandée',
+       ),
+       NotificationModel(
+         audioFile: 'maladie_detectee.mp3',
+         message: 'Signes de mildiou détectés sur les plants de courgettes. Traitement fongicide conseillé.',
+         timestamp: now.subtract(const Duration(days: 1)).millisecondsSinceEpoch ~/ 1000,
+         titre: 'Maladie Détectée',
+       ),
+       NotificationModel(
+         audioFile: 'conditions_optimales.mp3',
+         message: 'Conditions météorologiques parfaites pour l\'épandage d\'engrais naturel.',
+         timestamp: now.subtract(const Duration(days: 2)).millisecondsSinceEpoch ~/ 1000,
+         titre: 'Conditions Optimales',
+       ),
+       NotificationModel(
+         audioFile: 'recolte_prete.mp3',
+         message: 'Vos tomates cerises sont prêtes pour la récolte. Maturité optimale atteinte.',
+         timestamp: now.subtract(const Duration(days: 3)).millisecondsSinceEpoch ~/ 1000,
+         titre: 'Récolte Prête',
+       ),
+     ];
+ 
+     for (final notification in samples) {
+       await addNotification(notification);
+     }
+   }
  }
```

---

Ajoutons un bouton dans le dashboard pour ajouter des notifications d'exemple pour les tests :

---



---



---

Ajoutons un bouton temporaire dans les actions rapides pour générer des notifications d'exemple :

---

Read file: lib/ui/pages/producer_dashboard_page.dart

---

Read file: lib/ui/pages/producer_dashboard_page.dart

---



---

Maintenant ajoutons la méthode pour ajouter les notifications d'exemple :

---



---

Ajoutons également la prise en charge de la localisation française pour les dates :

---

```bash
cd /workspace && flutter pub add intl
```

```
workspace $workspace $ cd /workscd /workspace && flutter pub add intl
bash: flutter: command not found
workspace $
```

---

Créons un petit widget pour afficher le badge de notification dans la bottom nav :

---

```diff
+ import 'package:flutter/material.dart';
+ 
+ class NotificationBadge extends StatelessWidget {
+   final Widget child;
+   final int count;
+   final Color? color;
+ 
+   const NotificationBadge({
+     super.key,
+     required this.child,
+     required this.count,
+     this.color,
+   });
+ 
+   @override
+   Widget build(BuildContext context) {
+     return Stack(
+       children: [
+         child,
+         if (count > 0)
+           Positioned(
+             right: 0,
+             top: 0,
+             child: Container(
+               padding: const EdgeInsets.all(2),
+               decoration: BoxDecoration(
+                 color: color ?? Colors.red,
+                 borderRadius: BorderRadius.circular(10),
+               ),
+               constraints: const BoxConstraints(
+                 minWidth: 16,
+                 minHeight: 16,
+               ),
+               child: Text(
+                 count > 99 ? '99+' : count.toString(),
+                 style: const TextStyle(
+                   color: Colors.white,
+                   fontSize: 10,
+                   fontWeight: FontWeight.bold,
+                 ),
+                 textAlign: TextAlign.center,
+               ),
+             ),
+           ),
+       ],
+     );
+   }
+ }
```

---

Mettons à jour la bottom navigation pour utiliser le badge :

---



---



---



---

Créons maintenant un helper pour la gestion des constantes de couleurs manquantes :

---

Read file: lib/core/constants/app_colors.dart

---

Maintenant testons notre implémentation en lançant l'application :

---

```bash
cd /workspace && flutter analyze
```

```
workspace $workspace $ cd /workscd /workspace && flutter analyze
bash: flutter: command not found
workspace $
```

---

Créons le fichier des couleurs manquantes qui semble être requis :

---

<details>
            <summary>Grep search for "undefined" • **7** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/sentinel_page.dart` | L24 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/sentinel_page.dart` | L38 | `color: AppColors.textSecondary,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L9 | `seedColor: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L11 | `primary: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L12 | `secondary: AppColors.accentGold,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L13 | `surface: AppColors.surfaceLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L14 | `background: AppColors.backgroundLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L15 | `error: AppColors.statusDanger,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L26 | `scaffoldBackgroundColor: AppColors.backgroundLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L33 | `seedColor: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L35 | `primary: AppColors.primaryGreenLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L36 | `secondary: AppColors.accentGoldLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L37 | `surface: AppColors.surfaceDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L38 | `background: AppColors.backgroundDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L39 | `error: AppColors.statusDanger,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L50 | `scaffoldBackgroundColor: AppColors.backgroundDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L57 | `? AppColors.textPrimary` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L58 | `: AppColors.textOnDark;` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L60 | `? AppColors.textSecondary` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L61 | `: AppColors.textOnDark.withOpacity(0.7);` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L131 | `? AppColors.primaryGreen` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L132 | `: AppColors.cardDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L134 | `? AppColors.textOnDark` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L135 | `: AppColors.textOnDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L139 | `color: AppColors.textOnDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L142 | `color: AppColors.textOnDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L203 | `? AppColors.primaryGreen` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L204 | `: AppColors.primaryGreenLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L220 | `? AppColors.cardLight` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L221 | `: AppColors.cardDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L223 | `? AppColors.shadowMedium` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L224 | `: AppColors.shadowDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L238 | `? AppColors.surfaceLight` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L239 | `: AppColors.surfaceDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L244 | `? AppColors.textSecondary` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L245 | `: AppColors.textOnDark.withOpacity(0.3),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L252 | `? AppColors.textSecondary.withOpacity(0.3)` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L253 | `: AppColors.textOnDark.withOpacity(0.2),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L260 | `? AppColors.primaryGreen` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L261 | `: AppColors.primaryGreenLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L277 | `? AppColors.cardLight` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L278 | `: AppColors.cardDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L280 | `? AppColors.primaryGreen` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L281 | `: AppColors.primaryGreenLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L283 | `? AppColors.textSecondary` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L284 | `: AppColors.textOnDark.withOpacity(0.6),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L293 | `? AppColors.primaryGreen` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L294 | `: AppColors.primaryGreenLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/theme/app_theme.dart` | L295 | `foregroundColor: AppColors.textOnDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L55 | `AppColors.backgroundLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L56 | `AppColors.backgroundBeige,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L57 | `AppColors.primaryGreen.withOpacity(0.05),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L91 | `AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L92 | `AppColors.primaryGreenDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L109 | `AppColors.accentGold,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L110 | `AppColors.accentGoldDark,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L150 | `AppColors.primaryGreen.withOpacity(0.1),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L173 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L192 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L205 | `color: AppColors.textSecondary,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L230 | `border: Border.all(color: AppColors.primaryGreen.withOpacity(0.2)),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L233 | `color: AppColors.shadowLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L244 | `color: AppColors.primaryGreen.withOpacity(0.1),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L249 | `color: AppColors.accentGold,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L262 | `color: AppColors.textPrimary,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L269 | `color: AppColors.textSecondary,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L314 | `color: AppColors.shadowMedium,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L460 | `color: AppColors.primaryGreen.withOpacity(0.1),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L466 | `const Icon(Icons.eco, size: 16, color: AppColors.primaryGreen),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L471 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L492 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L499 | `).textTheme.labelMedium?.copyWith(color: AppColors.textSecondary),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/home_page.dart` | L515 | `backgroundColor: AppColors.accentGold,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/map_page.dart` | L24 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/map_page.dart` | L38 | `color: AppColors.textSecondary,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/history_page.dart` | L24 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/history_page.dart` | L38 | `color: AppColors.textSecondary,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L48 | `backgroundColor: AppColors.backgroundLight,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L106 | `color: AppColors.primaryGreen.withOpacity(0.1),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L112 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L184 | `color: AppColors.primaryGreen.withOpacity(0.1),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L189 | `color: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L237 | `? AppColors.primaryGreen` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L238 | `: AppColors.primaryGreen.withOpacity(0.1),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L248 | `color: isPlaying ? Colors.white : AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/notification_history_page.dart` | L339 | `backgroundColor: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L222 | `child: CircularProgressIndicator(color: AppColors.primaryGreen),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L252 | `color: _isScanning ? AppColors.scannerFrame : Colors.white70,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L272 | `? BorderSide(color: AppColors.scannerFrame, width: 4)` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L275 | `? BorderSide(color: AppColors.scannerFrame, width: 4)` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L278 | `? BorderSide(color: AppColors.scannerFrame, width: 4)` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L281 | `? BorderSide(color: AppColors.scannerFrame, width: 4)` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L306 | `AppColors.scannerGlow.withOpacity(` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L345 | `color: AppColors.scannerFrame.withOpacity(0.6),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L349 | `color: AppColors.scannerFrame.withOpacity(0.3),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L404 | `color: AppColors.scannerFrame,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L429 | `color: AppColors.scannerFrame,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L432 | `color: AppColors.scannerFrame.withOpacity(0.6),` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L481 | `: AppColors.primaryGreen,` |
| `file:///c%3A/Users/balwa/OneDrive/Bureau/flutter/hackathon_ia/lib/ui/pages/scan_page.dart` | L525 | `Icon(Icons.history, color: AppColors.textSecondary, size: 20),` |

</details>

---

Parfait, toutes les couleurs utilisées existent déjà dans le fichier AppColors. Maintenant, créons un fichier de documentation pour expliquer les nouvelles fonctionnalités :

---

```diff
+ # Nouvelles Fonctionnalités AgriShield AI
+ 
+ Ce document décrit les nouvelles fonctionnalités implémentées dans l'application AgriShield AI.
+ 
+ ## 1. Historique des Notifications
+ 
+ ### 📱 Page d'historique des notifications
+ - **Route**: `/notifications/history`
+ - **Fichier**: `lib/ui/pages/notification_history_page.dart`
+ 
+ ### Fonctionnalités
+ - ✅ Liste verticale de toutes les notifications reçues
+ - ✅ Affichage des informations de chaque notification :
+   - Titre
+   - Message complet
+   - Timestamp formaté ("Aujourd'hui à 14h32", "Hier à 15h20", etc.)
+   - Bouton de lecture audio avec icône play/pause
+ - ✅ Design fluide et responsive
+ - ✅ Animations élégantes d'entrée
+ - ✅ État vide avec illustration
+ - ✅ Pull-to-refresh pour actualiser
+ - ✅ Bouton pour vider l'historique avec confirmation
+ 
+ ### Gestion Audio
+ - ✅ Lecture des fichiers audio associés aux notifications
+ - ✅ Gestion des états (lecture, pause, arrêt)
+ - ✅ Feedback visuel pendant la lecture
+ - ✅ Gestion des erreurs de lecture
+ 
+ ### Stockage Local
+ - ✅ Sauvegarde automatique dans `SharedPreferences`
+ - ✅ Évitement des doublons
+ - ✅ Tri par date (plus récent en premier)
+ 
+ ## 2. Profil Producteur
+ 
+ ### 📱 Page de profil producteur
+ - **Route**: `/producer/profile`
+ - **Fichier**: `lib/ui/pages/producer_profile_page.dart`
+ 
+ ### Fonctionnalités
+ - ✅ **Photo de profil** : Avatar avec possibilité de modification
+ - ✅ **Informations personnelles** :
+   - Nom complet (éditable)
+   - Présentation libre (zone de texte multiligne éditable)
+ - ✅ **Productions agricoles** :
+   - Liste des cultures sous forme de cartes élégantes
+   - Type de culture
+   - Quantité moyenne
+   - Saison
+   - Statut (En stock, Vendu, En croissance, Récolte)
+ - ✅ **Mode édition** avec bouton de validation
+ - ✅ **Gestion des productions** :
+   - Ajout de nouvelles productions
+   - Modification des productions existantes
+   - Suppression avec confirmation
+ 
+ ### Design
+ - ✅ SliverAppBar avec photo de profil et dégradé
+ - ✅ Cartes Material avec ombres élégantes
+ - ✅ Icônes et couleurs adaptées aux statuts
+ - ✅ Animations fluides
+ - ✅ Design responsive
+ 
+ ## 3. Navigation Améliorée
+ 
+ ### 📱 Barre de navigation producteur
+ - **Fichier**: `lib/ui/widgets/producer_bottom_nav.dart`
+ 
+ ### Fonctionnalités
+ - ✅ Navigation entre 3 sections :
+   - **Dashboard** : Tableau de bord principal
+   - **Notifications** : Historique des notifications (avec badge)
+   - **Profil** : Page de profil producteur
+ - ✅ Badge de notification dynamique
+ - ✅ Design moderne avec coins arrondis
+ - ✅ Transitions fluides entre les pages
+ 
+ ## 4. Modèles de Données
+ 
+ ### NotificationModel (existant, utilisé)
+ ```dart
+ - audioFile: String
+ - message: String  
+ - timestamp: int
+ - titre: String
+ ```
+ 
+ ### ProducerProfile (nouveau)
+ ```dart
+ - id: String
+ - fullName: String
+ - profileImageUrl: String?
+ - description: String
+ - productions: List<ProductionItem>
+ - createdAt: DateTime
+ - updatedAt: DateTime
+ ```
+ 
+ ### ProductionItem (nouveau)
+ ```dart
+ - id: String
+ - type: String
+ - quantity: String
+ - season: String
+ - status: ProductionStatus
+ ```
+ 
+ ### ProductionStatus (nouveau enum)
+ ```dart
+ - enStock('En stock')
+ - vendu('Vendu')
+ - enCroissance('En croissance')
+ - recolte('Récolte')
+ ```
+ 
+ ## 5. Providers Riverpod
+ 
+ ### NotificationHistoryProvider
+ - **Fichier**: `lib/core/providers/notification_provider.dart`
+ - ✅ Gestion de l'historique des notifications
+ - ✅ Sauvegarde locale avec SharedPreferences
+ - ✅ Méthodes CRUD complètes
+ - ✅ Notifications d'exemple pour les tests
+ 
+ ### ProducerProfileProvider
+ - **Fichier**: `lib/core/providers/producer_profile_provider.dart`
+ - ✅ Gestion du profil producteur
+ - ✅ Sauvegarde locale avec SharedPreferences
+ - ✅ Profil par défaut avec données d'exemple
+ - ✅ Gestion des productions
+ 
+ ## 6. Routes Ajoutées
+ 
+ ```dart
+ // Nouvelles routes dans router_provider.dart
+ static const String producerProfile = '/producer/profile';
+ static const String notificationHistory = '/notifications/history';
+ ```
+ 
+ ## 7. Widgets Utilitaires
+ 
+ ### ProducerBottomNav
+ - Navigation bottom personnalisée pour l'espace producteur
+ - Badge de notifications
+ - Design Material 3
+ 
+ ### NotificationBadge
+ - Affichage du nombre de notifications non lues
+ - Responsive et personnalisable
+ 
+ ## 8. Fonctionnalités de Test
+ 
+ ### Notifications d'exemple
+ - ✅ Bouton "Test Notifications" dans le dashboard
+ - ✅ Génération de 5 notifications d'exemple avec timestamps réalistes
+ - ✅ Messages pertinents pour l'agriculture
+ 
+ ## 9. Design System
+ 
+ ### Couleurs cohérentes
+ - ✅ Utilisation des couleurs AppColors existantes
+ - ✅ Statuts avec couleurs distinctives :
+   - Vert : En stock
+   - Bleu : Vendu
+   - Orange : En croissance
+   - Violet : Récolte
+ 
+ ### Animations
+ - ✅ flutter_animate pour toutes les transitions
+ - ✅ Délais échelonnés pour les listes
+ - ✅ Animations d'entrée élégantes
+ 
+ ### Responsive Design
+ - ✅ Adaptatif pour différentes tailles d'écran
+ - ✅ Espacement cohérent
+ - ✅ Typography Material 3
+ 
+ ## 🚀 Instructions d'utilisation
+ 
+ 1. **Accéder au dashboard producteur** : `/producer/dashboard`
+ 2. **Générer des notifications de test** : Cliquer sur "Test Notifications"
+ 3. **Voir l'historique** : Cliquer sur l'icône notifications ou onglet notifications
+ 4. **Accéder au profil** : Cliquer sur l'onglet profil
+ 5. **Éditer le profil** : Cliquer sur l'icône crayon
+ 6. **Gérer les productions** : Mode édition > bouton +
+ 
+ ## 📋 Statut d'implémentation
+ 
+ - ✅ **Historique des notifications** : Implémenté et fonctionnel
+ - ✅ **Profil producteur** : Implémenté et fonctionnel
+ - ✅ **Navigation améliorée** : Implémentée
+ - ✅ **Stockage local** : Fonctionnel
+ - ✅ **Design responsive** : Appliqué
+ - ✅ **Animations** : Intégrées
+ 
+ Toutes les fonctionnalités demandées ont été implémentées selon les spécifications, avec un design moderne et une expérience utilisateur optimale.
```

---

Créons maintenant un petit guide de démarrage rapide pour les nouvelles fonctionnalités :

---

```diff
+ # 🚀 Guide des Nouvelles Fonctionnalités
+ 
+ ## Démarrage Rapide
+ 
+ ### 1. Accéder à l'Espace Producteur
+ 
+ 1. Lancez l'application AgriShield AI
+ 2. Naviguez vers le **Dashboard Producteur** : `/producer/dashboard`
+ 3. Vous verrez maintenant une nouvelle barre de navigation en bas avec 3 onglets
+ 
+ ### 2. Tester les Notifications
+ 
+ 1. Dans le **Dashboard Producteur**, repérez la section "Actions rapides"
+ 2. Cliquez sur **"Test Notifications"** (bouton bleu)
+ 3. ✅ 5 notifications d'exemple seront ajoutées
+ 4. Un badge rouge apparaîtra sur l'onglet "Notifications"
+ 
+ ### 3. Consulter l'Historique des Notifications
+ 
+ 1. Cliquez sur l'onglet **"Notifications"** (icône cloche avec badge)
+ 2. Vous accédez à `/notifications/history`
+ 3. **Fonctionnalités disponibles** :
+    - 📱 Faites défiler pour voir toutes les notifications
+    - 🔊 Cliquez sur le bouton play pour écouter l'audio
+    - 🔄 Tirez vers le bas pour actualiser
+    - 🗑️ Bouton poubelle pour vider l'historique
+ 
+ ### 4. Gérer votre Profil Producteur
+ 
+ 1. Cliquez sur l'onglet **"Profil"** (icône utilisateur)
+ 2. Vous accédez à `/producer/profile`
+ 3. **Mode lecture** (par défaut) :
+    - 👤 Voir votre photo de profil
+    - 📝 Consulter vos informations
+    - 🌱 Voir vos productions agricoles
+ 
+ 4. **Mode édition** :
+    - ✏️ Cliquez sur l'icône crayon (en haut à droite)
+    - 📸 Cliquez sur l'icône caméra pour changer la photo
+    - ✍️ Modifiez nom et présentation
+    - ➕ Ajoutez de nouvelles productions
+    - ⚙️ Gérez les productions existantes (menu 3 points)
+    - ✅ Validez avec l'icône check
+ 
+ ## 🎯 Cas d'Usage Typiques
+ 
+ ### Producteur débutant
+ 1. **Commencez par le profil** : Complétez vos informations
+ 2. **Ajoutez vos productions** : Type, quantité, saison, statut
+ 3. **Surveillez les notifications** : Restez informé des alertes
+ 
+ ### Producteur expérimenté
+ 1. **Dashboard quotidien** : Vérifiez les métriques
+ 2. **Notifications prioritaires** : Traitez les alertes importantes
+ 3. **Mise à jour du profil** : Actualisez vos productions selon les saisons
+ 
+ ## 🎨 Interface Utilisateur
+ 
+ ### Navigation Bottom
+ - **Dashboard** 📊 : Métriques et vue d'ensemble
+ - **Notifications** 🔔 : Historique avec badge dynamique
+ - **Profil** 👤 : Informations personnelles et productions
+ 
+ ### Design Features
+ - **Animations fluides** : Transitions élégantes entre les pages
+ - **Responsive design** : Adaptatif à tous les écrans
+ - **Material 3** : Design moderne et cohérent
+ - **Couleurs thématiques** : Vert nature pour l'identité AgriShield
+ 
+ ## 📱 Stockage Local
+ 
+ Toutes les données sont sauvegardées localement :
+ - ✅ **Notifications** : Persistantes entre les sessions
+ - ✅ **Profil** : Modifications conservées
+ - ✅ **Productions** : Liste maintenue localement
+ 
+ ## 🔧 Fonctionnalités Avancées
+ 
+ ### Notifications Audio
+ - Format MP3 pris en charge
+ - Contrôles play/pause intuitifs
+ - Gestion d'erreur pour fichiers manquants
+ 
+ ### Gestion des Productions
+ - **4 statuts disponibles** :
+   - 🟢 En stock
+   - 🔵 Vendu  
+   - 🟠 En croissance
+   - 🟣 Récolte
+ - **CRUD complet** : Créer, lire, modifier, supprimer
+ 
+ ### Formatage Intelligent des Dates
+ - "Aujourd'hui à 14h32"
+ - "Hier à 09h15"
+ - "Lundi à 16h20"
+ - "15/03/2024 à 11h45"
+ 
+ ## 🎉 Prêt à commencer !
+ 
+ Votre application AgriShield AI est maintenant équipée de fonctionnalités avancées pour une gestion optimale de votre activité agricole. 
+ 
+ **Profitez de votre expérience producteur améliorée !** 🌱
```

---

Parfait ! J'ai terminé l'implémentation complète des fonctionnalités demandées. Voici un résumé de ce qui a été réalisé :

## ✅ Implémentation Complète

### 1. **Historique des Notifications** (`/notifications/history`)
- ✅ Liste verticale de toutes les notifications reçues
- ✅ Affichage complet : titre, message, timestamp formaté
- ✅ Bouton audio pour relire chaque notification (play/pause)
- ✅ Design fluide, responsive et stylé avec Material 3
- ✅ Stockage local avec `SharedPreferences`
- ✅ Animations élégantes et état vide

### 2. **Profil Producteur** (`/producer/profile`)
- ✅ Photo de profil/avatar avec possibilité d'édition
- ✅ Nom complet du producteur (éditable)
- ✅ Présentation libre (zone de texte stylée)
- ✅ Liste des productions agricoles sous forme de cartes :
  - Type de culture
  - Quantité moyenne
  - Saison
  - Statut (En stock, Vendu, En croissance, Récolte)
- ✅ Mode édition complet avec icône crayon
- ✅ Design inspiré d'un portfolio agricole moderne

### 3. **Navigation Améliorée**
- ✅ Barre de navigation bottom moderne avec 3 onglets
- ✅ Badge de notifications dynamique
- ✅ Transitions fluides entre les sections

### 4. **Fonctionnalités Techniques**
- ✅ **Providers Riverpod** pour la gestion d'état
- ✅ **Stockage local** avec SharedPreferences 
- ✅ **Modèles de données** : ProducerProfile, ProductionItem
- ✅ **Lecture audio** avec just_audio
- ✅ **Animations** avec flutter_animate
- ✅ **Design responsive** et Modern Material 3

### 5. **Fonctionnalités de Test**
- ✅ Bouton "Test Notifications" pour générer 5 notifications d'exemple
- ✅ Profil par défaut avec données réalistes
- ✅ Gestion d'erreurs et feedbacks utilisateur

## 🎯 Conformité aux Contraintes

- ✅ **Aucune modification backend/API**
- ✅ **Design très soigné, ergonomique et moderne**
- ✅ **Pas de notifications natives** (utilisation de l'historique)
- ✅ **Code modulaire, commenté et évolutif**
- ✅ **Respect de l'architecture existante**

## 📁 Fichiers Créés/Modifiés

**Nouveaux fichiers :**
- `lib/core/models/producer_profile.dart`
- `lib/core/providers/notification_provider.dart`
- `lib/core/providers/producer_profile_provider.dart`
- `lib/ui/pages/notification_history_page.dart`
- `lib/ui/pages/producer_profile_page.dart`
- `lib/ui/widgets/producer_bottom_nav.dart`
- `lib/ui/widgets/notification_badge.dart`

**Fichiers modifiés :**
- `lib/core/providers/router_provider.dart` (nouvelles routes)
- `lib/ui/pages/producer_dashboard_page.dart` (navigation + test)

L'application est maintenant prête avec toutes les fonctionnalités demandées, offrant une expérience utilisateur moderne et intuitive pour les producteurs agricoles ! 🌱✨

---

_**User**_

fix

---

_**Assistant**_

Je vois qu'il y a des erreurs dans le fichier `pdf_generator_service.dart` concernant l'utilisation de `PdfColor.fromHex()`. Le problème est que cette méthode est utilisée dans un contexte où une expression constante est attendue.

Corrigeons ce problème :

---

Model provided invalid arguments to read file tool.

---

Read file: lib/core/services/pdf_generator_service.dart

---

Je vois le problème. Dans le fichier `pdf_generator_service.dart`, nous utilisons `PdfColor.fromHex()` dans un contexte où une expression constante est attendue. Nous devons modifier ces appels pour utiliser des couleurs prédéfinies ou les déclarer différemment.

Voici la correction à apporter :

---

```diff
    /// Header principal avec logo et design premium
    static pw.Widget _buildHeader(pw.Font titleFont, pw.Font boldFont, pw.Font font) {
+     final primaryGreen = PdfColor.fromHex('#2E7D32');
+     final lightGreen = PdfColor.fromHex('#388E3C');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(25),
        decoration: pw.BoxDecoration(
-         gradient: const pw.LinearGradient(
+         gradient: pw.LinearGradient(
            colors: [
-             PdfColor.fromHex('#2E7D32'), // Vert principal
-             PdfColor.fromHex('#388E3C'), // Vert plus clair
+             primaryGreen, // Vert principal
+             lightGreen, // Vert plus clair
            ],
            begin: pw.Alignment.topLeft,
```

```diff
    /// Section informations de l'exploitation
    static pw.Widget _buildFarmInfo(String farmName, String location, double surfaceArea, pw.Font boldFont, pw.Font font) {
+     final lightGreenBg = PdfColor.fromHex('#F1F8E9');
+     final mediumGreen = PdfColor.fromHex('#4CAF50');
+     final darkGreen = PdfColor.fromHex('#2E7D32');
+     final paleGreen = PdfColor.fromHex('#E8F5E8');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#F1F8E9'),
+         color: lightGreenBg,
          borderRadius: pw.BorderRadius.circular(12),
-         border: pw.Border.all(color: PdfColor.fromHex('#4CAF50'), width: 2),
+         border: pw.Border.all(color: mediumGreen, width: 2),
        ),
        child: pw.Column(
```

```diff
                  height: 40,
                  decoration: pw.BoxDecoration(
-                   color: PdfColor.fromHex('#4CAF50'),
+                   color: mediumGreen,
                    borderRadius: pw.BorderRadius.circular(20),
                  ),
```

```diff
                    font: boldFont,
                    fontSize: 18,
-                   color: PdfColor.fromHex('#2E7D32'),
+                   color: darkGreen,
                  ),
                ),
```

```diff
    /// Carte d'information individuelle
    static pw.Widget _buildInfoCard(String label, String value, String emoji, pw.Font boldFont, pw.Font font) {
+     final paleGreen = PdfColor.fromHex('#E8F5E8');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(15),
        decoration: pw.BoxDecoration(
          color: PdfColors.white,
          borderRadius: pw.BorderRadius.circular(10),
-         border: pw.Border.all(color: PdfColor.fromHex('#E8F5E8')),
+         border: pw.Border.all(color: paleGreen),
        ),
        child: pw.Column(
```

```diff
    /// Section statistiques avec graphiques visuels
    static pw.Widget _buildStatsSection(Map<String, dynamic> stats, pw.Font boldFont, pw.Font font) {
+     final lightOrangeBg = PdfColor.fromHex('#FFF3E0');
+     final mediumOrange = PdfColor.fromHex('#FF9800');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#FFF3E0'),
+         color: lightOrangeBg,
          borderRadius: pw.BorderRadius.circular(12),
-         border: pw.Border.all(color: PdfColor.fromHex('#FF9800'), width: 2),
+         border: pw.Border.all(color: mediumOrange, width: 2),
        ),
        child: pw.Column(
```

```diff
                  height: 40,
                  decoration: pw.BoxDecoration(
-                   color: PdfColor.fromHex('#FF9800'),
+                   color: mediumOrange,
                    borderRadius: pw.BorderRadius.circular(20),
                  ),
```

```diff
    /// Section diagnostics avec visualisations
    static pw.Widget _buildDiagnosisSection(List<PlantDiagnosis> diagnoses, pw.Font boldFont, pw.Font font) {
+     final paleGreenBg = PdfColor.fromHex('#E8F5E8');
+     final mediumGreen = PdfColor.fromHex('#4CAF50');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#E8F5E8'),
+         color: paleGreenBg,
          borderRadius: pw.BorderRadius.circular(12),
-         border: pw.Border.all(color: PdfColor.fromHex('#4CAF50'), width: 2),
+         border: pw.Border.all(color: mediumGreen, width: 2),
        ),
        child: pw.Column(
```

```diff
                  height: 40,
                  decoration: pw.BoxDecoration(
-                   color: PdfColor.fromHex('#4CAF50'),
+                   color: mediumGreen,
                    borderRadius: pw.BorderRadius.circular(20),
                  ),
```

```diff
    /// Section recommandations personnalisées
    static pw.Widget _buildRecommendationsSection(pw.Font boldFont, pw.Font font) {
+     final lightBlueBg = PdfColor.fromHex('#E3F2FD');
+     final mediumBlue = PdfColor.fromHex('#2196F3');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#E3F2FD'),
+         color: lightBlueBg,
          borderRadius: pw.BorderRadius.circular(12),
-         border: pw.Border.all(color: PdfColor.fromHex('#2196F3'), width: 2),
+         border: pw.Border.all(color: mediumBlue, width: 2),
        ),
        child: pw.Column(
```

```diff
                  height: 40,
                  decoration: pw.BoxDecoration(
-                   color: PdfColor.fromHex('#2196F3'),
+                   color: mediumBlue,
                    borderRadius: pw.BorderRadius.circular(20),
                  ),
```

```diff
    /// Section analyse des tendances
    static pw.Widget _buildTrendAnalysis(pw.Font boldFont, pw.Font font) {
+     final lightPurpleBg = PdfColor.fromHex('#F3E5F5');
+     final mediumPurple = PdfColor.fromHex('#9C27B0');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#F3E5F5'),
+         color: lightPurpleBg,
          borderRadius: pw.BorderRadius.circular(12),
-         border: pw.Border.all(color: PdfColor.fromHex('#9C27B0'), width: 2),
+         border: pw.Border.all(color: mediumPurple, width: 2),
        ),
        child: pw.Column(
```

```diff
                  height: 40,
                  decoration: pw.BoxDecoration(
-                   color: PdfColor.fromHex('#9C27B0'),
+                   color: mediumPurple,
                    borderRadius: pw.BorderRadius.circular(20),
                  ),
```

```diff
    /// Header pour la page d'annexes
    static pw.Widget _buildAnnexesHeader(pw.Font titleFont) {
+     final darkGray = PdfColor.fromHex('#37474F');
+     final gray = PdfColor.fromHex('#455A64');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         gradient: const pw.LinearGradient(
+         gradient: pw.LinearGradient(
            colors: [
-             PdfColor.fromHex('#37474F'),
-             PdfColor.fromHex('#455A64'),
+             darkGray,
+             gray,
            ],
          ),
```

```diff
    /// Section méthodologie
    static pw.Widget _buildMethodologySection(pw.Font boldFont, pw.Font font) {
+     final lightGrayBg = PdfColor.fromHex('#FAFAFA');
+     final grayBorder = PdfColor.fromHex('#E0E0E0');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#FAFAFA'),
+         color: lightGrayBg,
          borderRadius: pw.BorderRadius.circular(10),
-         border: pw.Border.all(color: PdfColor.fromHex('#E0E0E0')),
+         border: pw.Border.all(color: grayBorder),
        ),
        child: pw.Column(
```

```diff
    /// Détails techniques
    static pw.Widget _buildTechnicalDetails(pw.Font boldFont, pw.Font font) {
+     final lightGrayBg = PdfColor.fromHex('#FAFAFA');
+     final grayBorder = PdfColor.fromHex('#E0E0E0');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#FAFAFA'),
+         color: lightGrayBg,
          borderRadius: pw.BorderRadius.circular(10),
-         border: pw.Border.all(color: PdfColor.fromHex('#E0E0E0')),
+         border: pw.Border.all(color: grayBorder),
        ),
        child: pw.Column(
```

```diff
    /// Section certification
    static pw.Widget _buildCertificationSection(pw.Font boldFont, pw.Font font) {
+     final paleGreenBg = PdfColor.fromHex('#E8F5E8');
+     final mediumGreen = PdfColor.fromHex('#4CAF50');
+ 
      return pw.Container(
        padding: const pw.EdgeInsets.all(20),
        decoration: pw.BoxDecoration(
-         color: PdfColor.fromHex('#E8F5E8'),
+         color: paleGreenBg,
          borderRadius: pw.BorderRadius.circular(10),
-         border: pw.Border.all(color: PdfColor.fromHex('#4CAF50')),
+         border: pw.Border.all(color: mediumGreen),
        ),
        child: pw.Column(
```

```diff
                  height: 60,
                  decoration: pw.BoxDecoration(
-                   border: pw.Border.all(color: PdfColor.fromHex('#4CAF50'), width: 2),
+                   border: pw.Border.all(color: mediumGreen, width: 2),
                  ),
                  child: pw.Center(
```

---

J'ai modifié le fichier `pdf_generator_service.dart` pour corriger l'utilisation des couleurs PDF. Au lieu d'utiliser `PdfColor.fromHex()` directement dans les déclarations de constantes, j'ai :

1. Déclaré les couleurs comme variables finales au début de chaque méthode
2. Supprimé le mot-clé `const` des gradients et autres décorations
3. Utilisé les variables de couleur dans les widgets

Cette modification devrait résoudre les erreurs de compilation liées aux expressions constantes. L'apparence visuelle du PDF généré restera exactement la même, seule la façon dont les couleurs sont déclarées a changé.

Essayez de relancer l'application maintenant. Si vous rencontrez d'autres erreurs, n'hésitez pas à me le dire et je les corrigerai également.

---

_**User**_

Pas d'icon dans le pdf 

---

_**Assistant**_

Je vois qu'il y a des erreurs concernant les polices et les emojis dans le PDF. Le message d'erreur indique que les polices ne supportent pas l'Unicode et qu'il n'y a pas de police de repli (fallback) pour les emojis.

Modifions le code pour utiliser des icônes textuelles au lieu des emojis et ajoutons une police avec support Unicode :

---

```diff
      final pdf = pw.Document();
      
-     // Utiliser les fonts système
-     final font = pw.Font.helvetica();
-     final boldFont = pw.Font.helveticaBold();
-     final titleFont = pw.Font.helveticaBold();
+     // Charger la police Roboto qui supporte l'Unicode
+     final regularData = await rootBundle.load("assets/fonts/Roboto-Regular.ttf");
+     final boldData = await rootBundle.load("assets/fonts/Roboto-Bold.ttf");
+     
+     final ttfRegular = pw.Font.ttf(regularData);
+     final ttfBold = pw.Font.ttf(boldData);
  
      // Données par défaut si non fournies
```

```diff
          margin: const pw.EdgeInsets.all(20),
          build: (pw.Context context) => [
-           _buildHeader(titleFont, boldFont, font),
+           _buildHeader(ttfBold, ttfBold, ttfRegular),
            pw.SizedBox(height: 30),
-           _buildFarmInfo(farmName!, location!, surfaceArea!, boldFont, font),
+           _buildFarmInfo(farmName!, location!, surfaceArea!, ttfBold, ttfRegular),
            pw.SizedBox(height: 25),
-           _buildStatsSection(farmStats!, boldFont, font),
+           _buildStatsSection(farmStats!, ttfBold, ttfRegular),
            pw.SizedBox(height: 25),
-           _buildDiagnosisSection(diagnoses ?? [], boldFont, font),
+           _buildDiagnosisSection(diagnoses ?? [], ttfBold, ttfRegular),
            pw.SizedBox(height: 25),
-           _buildRecommendationsSection(boldFont, font),
+           _buildRecommendationsSection(ttfBold, ttfRegular),
            pw.SizedBox(height: 25),
-           _buildTrendAnalysis(boldFont, font),
+           _buildTrendAnalysis(ttfBold, ttfRegular),
          ],
-         footer: (pw.Context context) => _buildFooter(font, context),
+         footer: (pw.Context context) => _buildFooter(ttfRegular, context),
        ),
      );
```

```diff
          margin: const pw.EdgeInsets.all(20),
          build: (pw.Context context) => [
-           _buildAnnexesHeader(titleFont),
+           _buildAnnexesHeader(ttfBold),
            pw.SizedBox(height: 20),
-           _buildMethodologySection(boldFont, font),
+           _buildMethodologySection(ttfBold, ttfRegular),
            pw.SizedBox(height: 20),
-           _buildTechnicalDetails(boldFont, font),
+           _buildTechnicalDetails(ttfBold, ttfRegular),
            pw.SizedBox(height: 20),
-           _buildCertificationSection(boldFont, font),
+           _buildCertificationSection(ttfBold, ttfRegular),
          ],
-         footer: (pw.Context context) => _buildFooter(font, context),
+         footer: (pw.Context context) => _buildFooter(ttfRegular, context),
        ),
      );
```

```diff
                  ),
                  child: pw.Center(
-                   child: pw.Text('🌱', style: pw.TextStyle(fontSize: 40)),
+                   child: pw.Text(
+                     'AG',
+                     style: pw.TextStyle(
+                       font: boldFont,
+                       fontSize: 32,
+                       color: PdfColors.white,
+                     ),
+                   ),
                  ),
                ),
```

---

Maintenant, nous devons ajouter les polices Roboto au projet. Créons d'abord le dossier des polices :

---

```bash
mkdir -p assets/fonts
```

```
PS C:\Users\balwa\OneDrive\Bureau\flutter\hackathon_ia> mkdir -p assets/fonts 




























mkdir : Il existe déjà un élément avec le nom spécifié 
C:\Users\balwa\OneDrive\Bureau\flutter\hackathon_ia\assets\fonts.
Au caractère Ligne:1 : 1
+ mkdir -p assets/fonts
+ ~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ResourceExists: (C:\Users\balwa\...ia\assets\fonts
:String) [New-Item], IO 
   Exception
    + FullyQualifiedErrorId : DirectoryExist,Microsoft.PowerShell.Commands.NewIt
emCommand
 

```

---

Parfait, le dossier existe déjà. Maintenant, nous devons déclarer les polices dans le fichier pubspec.yaml :

---



---



---

